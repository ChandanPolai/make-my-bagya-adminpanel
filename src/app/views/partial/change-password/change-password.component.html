<main
  [class]="
    'tw-pt-4 tw-pb-4 tw-transition-all tw-duration-300 tw-overflow-auto ' +
    (isSidebarCollapsed ? ' tw-ml-16' : ' tw-ml-64')
  "
>
  <div class="tw-flex tw-items-center tw-justify-center tw-p-4 tw-min-h-[80vh]">
    <div class="tw-w-full tw-max-w-2xl">
      <div
        class="tw-rounded-2xl tw-backdrop-blur-sm tw-border tw-border-gray-300 tw-overflow-hidden tw-transform tw-transition-all tw-duration-300 tw-shadow-cyan-400 tw-bg-white"
      >
        <div
          [class]="
            'tw-px-8 tw-pt-8 tw-pb-1 tw-text-left tw-border-b-2 ' +
            currentTheme.secondary
          "
        >
          <h2 class="tw-text-2xl tw-font-bold tw-text-gray-800 tw-mb-2">
            Change Password
          </h2>
          <p [class]="'tw-text-gray-600 tw-text-sm' + currentTheme.secondary">
            Update your password to keep your account secure
          </p>
        </div>

        <!-- Security Icon Section -->
        <div class="tw-flex tw-justify-center tw-pt-8">
          <div class="tw-relative">
            <div
              [class]="
                'tw-w-28 tw-h-28 tw-rounded-full tw-flex tw-items-center tw-justify-center tw-border-4 tw-border-blue-100 tw-shadow-lg ' +
                currentTheme.primary
              "
            >
              <i class="ph ph-shield-check tw-text-white tw-text-5xl"></i>
            </div>
          </div>
        </div>
        
        <div class="tw-text-center tw-mt-2 tw-pb-4">
          <p class="tw-text-sm tw-text-gray-600 tw-font-medium">
            Secure Password Update
          </p>
        </div>

        <div class="tw-px-8 tw-pb-8 tw-pt-8">
          <!-- Loading Indicator -->
          <div *ngIf="isLoading" class="tw-flex tw-justify-center tw-items-center tw-py-8">
            <div class="tw-animate-spin tw-rounded-full tw-h-8 tw-w-8 tw-border-b-2 tw-border-blue-500"></div>
            <span class="tw-ml-2 tw-text-gray-600">Updating password...</span>
          </div>

          <form
            *ngIf="!isLoading"
            class="tw-space-y-6"
            (ngSubmit)="onSubmit()"
            [formGroup]="changePasswordForm"
          >
            <!-- Current Password -->
            <div class="tw-space-y-2">
              <label
                class="tw-text-[17px] tw-font-medium tw-text-gray-700 tw-block"
              >
                Current Password
              </label>
              <div class="tw-relative">
                <div
                  class="tw-absolute tw-inset-y-0 tw-pl-3 tw-flex tw-pointer-events-none"
                >
                  <i
                    class="ph ph-lock tw-text-gray-400 tw-text-lg tw-pt-2"
                  ></i>
                </div>
                <input
                  [type]="showCurrentPassword ? 'text' : 'password'"
                  placeholder="Enter your current password"
                  formControlName="currentPassword"
                  [class]="
                    'tw-w-full tw-pl-10 tw-pr-12 tw-py-2 tw-border tw-rounded-xl tw-text-sm tw-transition-all tw-duration-200 ' +
                    currentTheme.name +
                    '-200 focus:tw-border-' +
                    currentTheme.name +
                    '-400 tw-bg-white'
                  "
                />
                <button
                  type="button"
                  (click)="togglePasswordVisibility('current')"
                  class="tw-absolute tw-inset-y-0 tw-right-0 tw-pr-3 tw-flex tw-items-center tw-text-gray-400 hover:tw-text-gray-600 tw-transition-colors tw-duration-200"
                >
                  <i
                    [class]="
                      showCurrentPassword ? 'ph ph-eye-slash' : 'ph ph-eye'
                    "
                  ></i>
                </button>
              </div>
              <div *ngIf="changePasswordForm.get('currentPassword')?.invalid && changePasswordForm.get('currentPassword')?.touched" class="tw-text-red-500 tw-text-xs tw-mt-1">
                {{ getFieldError('currentPassword') }}
              </div>
            </div>

            <!-- New Password -->
            <div class="tw-space-y-2">
              <label
                class="tw-text-[17px] tw-font-medium tw-text-gray-700 tw-block"
              >
                New Password
              </label>
              <div class="tw-relative">
                <div
                  class="tw-absolute tw-inset-y-0 tw-pl-3 tw-flex tw-pointer-events-none"
                >
                  <i
                    class="ph ph-key tw-text-gray-400 tw-text-lg tw-pt-2"
                  ></i>
                </div>
                <input
                  [type]="showNewPassword ? 'text' : 'password'"
                  placeholder="Enter your new password"
                  formControlName="newPassword"
                  [class]="
                    'tw-w-full tw-pl-10 tw-pr-12 tw-py-2 tw-border tw-rounded-xl tw-text-sm tw-transition-all tw-duration-200 ' +
                    currentTheme.name +
                    '-200 focus:tw-border-' +
                    currentTheme.name +
                    '-400 tw-bg-white'
                  "
                />
                <button
                  type="button"
                  (click)="togglePasswordVisibility('new')"
                  class="tw-absolute tw-inset-y-0 tw-right-0 tw-pr-3 tw-flex tw-items-center tw-text-gray-400 hover:tw-text-gray-600 tw-transition-colors tw-duration-200"
                >
                  <i
                    [class]="showNewPassword ? 'ph ph-eye-slash' : 'ph ph-eye'"
                  ></i>
                </button>
              </div>
              <div *ngIf="changePasswordForm.get('newPassword')?.invalid && changePasswordForm.get('newPassword')?.touched" class="tw-text-red-500 tw-text-xs tw-mt-1">
                {{ getFieldError('newPassword') }}
              </div>
            </div>

            <!-- Confirm New Password -->
            <div class="tw-space-y-2">
              <label
                class="tw-text-[17px] tw-font-medium tw-text-gray-700 tw-block"
              >
                Confirm New Password
              </label>
              <div class="tw-relative">
                <div
                  class="tw-absolute tw-inset-y-0 tw-pl-3 tw-flex tw-pointer-events-none"
                >
                  <i
                    class="ph ph-shield-check tw-text-gray-400 tw-text-lg tw-pt-2"
                  ></i>
                </div>
                <input
                  [type]="showConfirmPassword ? 'text' : 'password'"
                  placeholder="Confirm your new password"
                  formControlName="confirmPassword"
                  [class]="
                    'tw-w-full tw-pl-10 tw-pr-12 tw-py-2 tw-border tw-rounded-xl tw-text-sm tw-transition-all tw-duration-200 ' +
                    currentTheme.name +
                    '-200 focus:tw-border-' +
                    currentTheme.name +
                    '-400 tw-bg-white'
                  "
                />
                <button
                  type="button"
                  (click)="togglePasswordVisibility('confirm')"
                  class="tw-absolute tw-inset-y-0 tw-right-0 tw-pr-3 tw-flex tw-items-center tw-text-gray-400 hover:tw-text-gray-600 tw-transition-colors tw-duration-200"
                >
                  <i
                    [class]="
                      showConfirmPassword ? 'ph ph-eye-slash' : 'ph ph-eye'
                    "
                  ></i>
                </button>
              </div>
              <div *ngIf="changePasswordForm.get('confirmPassword')?.invalid && changePasswordForm.get('confirmPassword')?.touched" class="tw-text-red-500 tw-text-xs tw-mt-1">
                {{ getFieldError('confirmPassword') }}
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="tw-pt-4 tw-flex tw-gap-4">
              <button
                type="submit"
                [disabled]="changePasswordForm.invalid || isLoading"
                [class]="'tw-btn-save ' + (changePasswordForm.invalid || isLoading ? 'tw-opacity-50 tw-cursor-not-allowed' : '')"
              >
                <i class="ph ph-floppy-disk tw-text-xl tw-me-1"></i>
                Update Password
              </button>

              <button
                type="button"
                (click)="onClear()"
                class="tw-btn-secondary"
              >
                <i class="ph ph-arrows-clockwise tw-text-xl tw-me-1"></i>
                Reset Form
              </button>
            </div>

            <!-- Gradient Line -->
            <div
              class="tw-absolute tw-bottom-0 tw-left-0 tw-w-full tw-h-1 tw-bg-gradient-to-r"
              [ngClass]="currentTheme.primaryGradientFrom + ' to-white'"
            ></div>

            <!-- Footer -->
            <div class="tw-text-center tw-mt-6">
              <p class="tw-text-sm tw-text-gray-600">
                Need help?
                <a href="#" [class]="'tw-font-medium ' + currentTheme.name">
                  Contact Support
                </a>
              </p>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</main>